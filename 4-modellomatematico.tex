\allowdisplaybreaks
\section{Modello matematico}
\paragraph{Definizione: turni, costanti}
\begin{align*}
	&D={1,\dots ,m} 
	&&\text{finestra temporale, $m=7$}\\
	&f(d,k) 
	&&\text{fabbisogno per lo slot $k$ del giorno $d$.}\\
	&T(d)
	&&\text{insieme degli slot temporali del giorno $d$.}\\
	&s(day, start, end, dur)\in S
	&&\text{turno definito da: giorno, slot d'inizio, slot di fine, durata in slot.}\\
	&Mh(c)\in {16,24,48}
	&&\text{monte ore contrattuale previsto per $c$.}\\
	&copre(s,d,k)\in {0,1}
	&&\text{turno $s$ copre slot $k$ del giorno $d$.}
\end{align*}

\subsection{Formulazione del problema base}
\paragraph{Funzione obiettivo}
\begin{align}
	&min f_1+f_2\\
	&f_1=\sum_{c \in C}\sum_{s \in S} 0.5 dur(s) x(c,s) 
	&&f_2=\sum_{d \in D}\sum_{c \in C} stacco(c,d)
\end{align}
\paragraph{Vincoli}
\begin{align}
	&Mh(c)\le 0.5*\sum_{s\in S}x(c,s)dur(s)\le maxOre_c\\
	&0\le \sum_{S(d)}x(c,s)\le j \quad \forall d\in D, \forall c\in C, 
	k =
	\begin{cases}
		2 & \text{se } c\in FT || (c\in PTW \land d\in {sab,dom})\\
		1 & \text{se } c\in PT \\
		0 & \text{altrimenti}
	\end{cases}\\
	&0.5*\sum_{S(d)}x(c,s)dur(s)\le 12 \quad \forall c\in C\\
	&x(c,s(d,s_1,e_1, dur_1))\le 1-x(c,s(d,s_2,e_2, dur_2))\notag\\
	&\forall c\in C:(e_1\ge s_2||s_1\le e_2)\land (s_1\ge e_2+1||s_2\ge e_1+1)\\
	&\sum_{S(d)}\sum_{c\in C}x(c,s)copre(s,d,k)\ge f(d,k) \quad \forall d\in D, \forall k\\
	& split(c,s1(d), s2(d)) \le x(c,s1(d))\\
	& split(c,s1(d), s2(d)) \le x(c,s2(d))\\
	& split(c,s1(d), s2(d)) \ge x(c,s1(d))+x(c,s2(d))-1\\
	&stacco(c,d)\ge split(c,s1(d), s2(d))*(start(s2)-end(s1)) \notag \\
	& \forall c\in C, \forall d\in D, \forall s1,s2\in S:day(s1)=day(s2)\\
	&riposo(c,d) \ge 1-0.5*\sum_{s\in S_d}x(c,s), \quad \forall c\in FT\cup PT, \forall d\in D\\
	&1 \le \sum_{d\in D} riposo(c,d)\le 2
\end{align}
\paragraph{Variabili e insiemi}
\begin{align*}
	&c(Mh, info, altro)\in C
	&&\text{cassiere}\\
	&x(c,s)\in {0,1}
	&&\text{$c$ viene assegnato al turno $s$}\\
	&l(c,d)\in {0,1}
	&&\text{$c$ lavora il giorno $d$}\\	
	&split(c,s1(d), s2(d)) \in {0,1}
	&&\text{$c$ ha due turni il giorno $d$}\\
	&stacco(c,d)\in \mathbb{N}
	&&\text{slot di stacco tra due turni giornalieri per $c$}\\
	&riposo(c,d)\in {0,1}
	&&\text{$c$ è di riposo il giorno $d$}\\
	&C=FT\cup PT\cup PTW
	&&\text{insieme dei cassieri}
\end{align*}

\subsection{Formulazione del problema esteso}
\paragraph{Straordinari}
\subparagraph{Funzione obiettivo}
\begin{align}
	&min f_3\\
	&f_3=\sum_{c \in C}O(c)
\end{align}
\subparagraph{Vincoli}
\begin{align}
	&O(c) \ge \sum_{s \in S} x(c,s)*dur(s)- Mh(c)
	&&\forall c \in C
\end{align}
\subparagraph{Variabili}
\begin{align*}
	&O(c)\in \mathbb{N}
\end{align*}
\pagebreak
\paragraph{Equità}
\subparagraph{Funzione obiettivo}
\begin{align}
	&\min f_4+f_5+f_6\\
	&f_4=\sum_{c\in C} \alpha_1 ore(c)^{+} + \beta_1 ore(c)^{-}\\
	&f_5=\sum_{s \in S, c\in C}pen(s)x(c,s)\\
	&f_6=\sum_{c\in (FT\cup PT)}riposoDomenicale(c)\\
\end{align}
\subparagraph{Vincoli}
\begin{align}
	&H(c)=\sum_{s\in S} 0.5*dur(s)*x(c,s)\\
	&ore(c)^{+}\ge H(c)-Mh(c)\\
	&ore(c)^{-}\ge Mh(c)-H(c)\\
	& ore(c)^{+}\ge 0,\quad ore(c)^{-}\ge 0
	&& \forall c\in C\\
	&riposoDomenicale(c)\le riposo(c,d) 
	&&\forall d\in D: 7\mid d
\end{align}
\subparagraph{Variabili e costanti}
\begin{align*}
	&H(c)\in \mathbb{R}\\
	& ore(c)^{+},ore(c)^{-}\in \mathbb{R}\\
	&pen(s) =
	\begin{cases}
		p_3 &\text{se } dur(s)=6\\
		p_{3.5} &\text{se } dur(s)=7\\
		0 &\text{se } dur(s)=8\\
		p_{4.5} &\text{se } dur(s)=9\\
		p_5 &\text{se } dur(s)=10
	\end{cases}\\
	&riposoDomenicale(c)\in {0,1}\\
	&\alpha_1, \alpha_2,\beta_1, \beta_2 \in {R}^+
\end{align*}
\pagebreak
\paragraph{Riposo continuato}
\subparagraph{Funzione obiettivo}
\begin{align}
	&\min f_7\\
	&f_7=\sum_{c\in (FT\cup PT)}\sum_{d\in D}riposoContinuato(c,d)
\end{align}
\subparagraph{Vincoli}
\begin{align}
	&riposoContinuato(c,d)\le riposo(c,d)\\
	&riposoContinuato(c,d)\le riposo(c,d+1)\\
	&riposoContinuato(c,d)\le riposo(c,d)+riposo(c,d+1)-1
\end{align}
\subparagraph{Variabili}
\begin{align*}
	&riposoContinuato(c,d)\in {0,1}
\end{align*}

\paragraph{Cassa-reparto}
\subparagraph{Funzione obiettivo}
\begin{align}
	&\min f_8\\
	&f_8=\sum_{d\in D}\sum_{k\in T(d)}\Delta(d,k)
\end{align}
\subparagraph{Vincoli}
\begin{align}
	& \Delta(d,k) \ge \sum_{c \in C}\sum_{s \in S(d)} pesoCopertura(c)*copre(s,d,k)x(c,s) - f(d,k)
	&& \forall d,k\\
	& pesoCopertura(c)=\{\rho_1, \rho_2\}
	&& \rho_1 = 1, \rho_2 < 1
\end{align}
\subparagraph{Variabili}
\begin{align*}
	&c(Mh, info) \quad -> \quad c(Mh, info, cassareparto)\\
	&\Delta(d,k)\in \mathbb{N}
\end{align*}
\pagebreak
\paragraph{Spazzatrice}
\subparagraph{Vincoli}
\begin{align}
	&\sum_{c\in C:c(spazzatrice)=0}\sum_{s\in S:copre(s,d,k)=1}x(c,s)=0 
	&&\forall d\in D, k={1, 2}\\
	&\sum_{c\in C:c(spazzatrice)=1}\sum_{s\in S:copre(s,d,k)=1}x(c,s)\ge f_{d,k} 
	&&\forall d\in D, k={1, 2}\\
	&x(c,s_1)\le 1-x(c,s_2) \quad \forall s_1,s_2\in S:day(s_1)=d\land copre(s_1,d,27)=1,\notag \\
	&day(s_2)=d+1\land copre(s_2, d+1, 1)=1 \forall d\in (D\setminus {7}) \\
	&x(c,s)=0 \quad \forall s\in S: copre(s,7,27)=1, \forall c\in C:c(spazzatrice)=1
\end{align}
\subparagraph{Variabili}
\begin{align*}
	&c(Mh, info, cassareparto) \quad ->
	&&c(Mh, info, cassareparto, spazzatrice)
\end{align*}
\paragraph{Funzione obiettivo finale}
\begin{align}
	\min \; & 
	\sum_{i}\lambda_if_i
	&&\lambda_i \in \mathbb{R}, i=1,...8
\end{align}